CREATE OR REPLACE VIEW "ROTUS LF"."INIT_per_LF_loading" AS (
  WITH "avg_size" AS (
     SELECT "landfill_capacity_by_size"."avg_waste_in_place_tons"
          , "landfill_capacity_by_size"."landfill_current_status"
          , CASE WHEN "landfill_capacity_by_size"."landfill_design_size_category" = 'small'::TEXT THEN 'LFSmall'::TEXT
                 WHEN "landfill_capacity_by_size"."landfill_design_size_category" = 'large'::TEXT THEN 'LFLarge'::TEXT
            ELSE NULL::TEXT
            END AS "LFSize"
     FROM "rotus"."landfill_capacity_by_size"
  )
  SELECT 'ROTUS LF.INIT_per_LF_loading[Active, LFLarge]'   AS "variable", COALESCE((SELECT "avg_size"."avg_waste_in_place_tons" AS "val" FROM "avg_size" WHERE "avg_size"."LFSize" = 'LFLarge'::TEXT AND "avg_size"."landfill_current_status" = 'open'::TEXT),   0::NUMERIC) AS "val_2015", NULL::NUMERIC AS "val_2016", NULL::NUMERIC AS "val_2017", NULL::NUMERIC AS "val_2018", NULL::NUMERIC AS "val_2019", NULL::NUMERIC AS "val_2020", NULL::NUMERIC AS "val_2021", NULL::NUMERIC AS "val_2022", NULL::NUMERIC AS "val_2023", NULL::NUMERIC AS "val_2024", NULL::NUMERIC AS "val_2025", NULL::NUMERIC AS "val_2026", NULL::NUMERIC AS "val_2027", NULL::NUMERIC AS "val_2028", NULL::NUMERIC AS "val_2029", NULL::NUMERIC AS "val_2030", NULL::NUMERIC AS "val_2031", NULL::NUMERIC AS "val_2032", NULL::NUMERIC AS "val_2033", NULL::NUMERIC AS "val_2034", NULL::NUMERIC AS "val_2035", NULL::NUMERIC AS "val_2036", NULL::NUMERIC AS "val_2037", NULL::NUMERIC AS "val_2038", NULL::NUMERIC AS "val_2039", NULL::NUMERIC AS "val_2040" UNION ALL
  SELECT 'ROTUS LF.INIT_per_LF_loading[Inactive, LFLarge]' AS "variable", COALESCE((SELECT "avg_size"."avg_waste_in_place_tons" AS "val" FROM "avg_size" WHERE "avg_size"."LFSize" = 'LFLarge'::TEXT AND "avg_size"."landfill_current_status" = 'closed'::TEXT), 0::NUMERIC) AS "val_2015", NULL::NUMERIC AS "val_2016", NULL::NUMERIC AS "val_2017", NULL::NUMERIC AS "val_2018", NULL::NUMERIC AS "val_2019", NULL::NUMERIC AS "val_2020", NULL::NUMERIC AS "val_2021", NULL::NUMERIC AS "val_2022", NULL::NUMERIC AS "val_2023", NULL::NUMERIC AS "val_2024", NULL::NUMERIC AS "val_2025", NULL::NUMERIC AS "val_2026", NULL::NUMERIC AS "val_2027", NULL::NUMERIC AS "val_2028", NULL::NUMERIC AS "val_2029", NULL::NUMERIC AS "val_2030", NULL::NUMERIC AS "val_2031", NULL::NUMERIC AS "val_2032", NULL::NUMERIC AS "val_2033", NULL::NUMERIC AS "val_2034", NULL::NUMERIC AS "val_2035", NULL::NUMERIC AS "val_2036", NULL::NUMERIC AS "val_2037", NULL::NUMERIC AS "val_2038", NULL::NUMERIC AS "val_2039", NULL::NUMERIC AS "val_2040" UNION ALL
  SELECT 'ROTUS LF.INIT_per_LF_loading[Active, LFSmall]'   AS "variable", COALESCE((SELECT "avg_size"."avg_waste_in_place_tons" AS "val" FROM "avg_size" WHERE "avg_size"."LFSize" = 'LFSmall'::TEXT AND "avg_size"."landfill_current_status" = 'open'::TEXT),   0::NUMERIC) AS "val_2015", NULL::NUMERIC AS "val_2016", NULL::NUMERIC AS "val_2017", NULL::NUMERIC AS "val_2018", NULL::NUMERIC AS "val_2019", NULL::NUMERIC AS "val_2020", NULL::NUMERIC AS "val_2021", NULL::NUMERIC AS "val_2022", NULL::NUMERIC AS "val_2023", NULL::NUMERIC AS "val_2024", NULL::NUMERIC AS "val_2025", NULL::NUMERIC AS "val_2026", NULL::NUMERIC AS "val_2027", NULL::NUMERIC AS "val_2028", NULL::NUMERIC AS "val_2029", NULL::NUMERIC AS "val_2030", NULL::NUMERIC AS "val_2031", NULL::NUMERIC AS "val_2032", NULL::NUMERIC AS "val_2033", NULL::NUMERIC AS "val_2034", NULL::NUMERIC AS "val_2035", NULL::NUMERIC AS "val_2036", NULL::NUMERIC AS "val_2037", NULL::NUMERIC AS "val_2038", NULL::NUMERIC AS "val_2039", NULL::NUMERIC AS "val_2040" UNION ALL
  SELECT 'ROTUS LF.INIT_per_LF_loading[Inactive, LFSmall]' AS "variable", COALESCE((SELECT "avg_size"."avg_waste_in_place_tons" AS "val" FROM "avg_size" WHERE "avg_size"."LFSize" = 'LFSmall'::TEXT AND "avg_size"."landfill_current_status" = 'closed'::TEXT), 0::NUMERIC) AS "val_2015", NULL::NUMERIC AS "val_2016", NULL::NUMERIC AS "val_2017", NULL::NUMERIC AS "val_2018", NULL::NUMERIC AS "val_2019", NULL::NUMERIC AS "val_2020", NULL::NUMERIC AS "val_2021", NULL::NUMERIC AS "val_2022", NULL::NUMERIC AS "val_2023", NULL::NUMERIC AS "val_2024", NULL::NUMERIC AS "val_2025", NULL::NUMERIC AS "val_2026", NULL::NUMERIC AS "val_2027", NULL::NUMERIC AS "val_2028", NULL::NUMERIC AS "val_2029", NULL::NUMERIC AS "val_2030", NULL::NUMERIC AS "val_2031", NULL::NUMERIC AS "val_2032", NULL::NUMERIC AS "val_2033", NULL::NUMERIC AS "val_2034", NULL::NUMERIC AS "val_2035", NULL::NUMERIC AS "val_2036", NULL::NUMERIC AS "val_2037", NULL::NUMERIC AS "val_2038", NULL::NUMERIC AS "val_2039", NULL::NUMERIC AS "val_2040"
);
