CREATE OR REPLACE VIEW "CA LF"."Avg_landfill_capacity_by_size" AS (
  WITH "avg_size" AS (SELECT "landfill_capacity_by_size"."avg_waste_in_place_tons"
                           , CASE WHEN "landfill_capacity_by_size"."landfill_design_size_category" = 'small'::TEXT THEN 'LFSmall'::TEXT
                                  WHEN "landfill_capacity_by_size"."landfill_design_size_category" = 'large'::TEXT THEN 'LFLarge'::TEXT
                             ELSE NULL::TEXT
                      END AS "LFSize"
                      FROM "ca"."landfill_capacity_by_size"
                      WHERE "landfill_capacity_by_size"."landfill_current_status" = 'open'::TEXT
  )
  SELECT 'CA LF.Avg_landfill_capacity_by_size[LFLarge]' AS "variable", COALESCE((SELECT "avg_waste_in_place_tons" FROM "avg_size" WHERE "LFSize" = 'LFLarge'), 0.0) AS "val_2015"
                                                                     , 0.0::NUMERIC                                                                                 AS "val_2016"
                                                                     , 0.0::NUMERIC                                                                                 AS "val_2017"
                                                                     , 0.0::NUMERIC                                                                                 AS "val_2018"
                                                                     , 0.0::NUMERIC                                                                                 AS "val_2019"
                                                                     , 0.0::NUMERIC                                                                                 AS "val_2020"
                                                                     , 0.0::NUMERIC                                                                                 AS "val_2021"
                                                                     , 0.0::NUMERIC                                                                                 AS "val_2022"
                                                                     , 0.0::NUMERIC                                                                                 AS "val_2023"
                                                                     , 0.0::NUMERIC                                                                                 AS "val_2024"
                                                                     , 0.0::NUMERIC                                                                                 AS "val_2025"
                                                                     , 0.0::NUMERIC                                                                                 AS "val_2026"
                                                                     , 0.0::NUMERIC                                                                                 AS "val_2027"
                                                                     , 0.0::NUMERIC                                                                                 AS "val_2028"
                                                                     , 0.0::NUMERIC                                                                                 AS "val_2029"
                                                                     , 0.0::NUMERIC                                                                                 AS "val_2030"
                                                                     , 0.0::NUMERIC                                                                                 AS "val_2031"
                                                                     , 0.0::NUMERIC                                                                                 AS "val_2032"
                                                                     , 0.0::NUMERIC                                                                                 AS "val_2033"
                                                                     , 0.0::NUMERIC                                                                                 AS "val_2034"
                                                                     , 0.0::NUMERIC                                                                                 AS "val_2035"
                                                                     , 0.0::NUMERIC                                                                                 AS "val_2036"
                                                                     , 0.0::NUMERIC                                                                                 AS "val_2037"
                                                                     , 0.0::NUMERIC                                                                                 AS "val_2038"
                                                                     , 0.0::NUMERIC                                                                                 AS "val_2039"
                                                                     , 0.0::NUMERIC                                                                                 AS "val_2040"
  UNION ALL
  SELECT 'CA LF.Avg_landfill_capacity_by_size[LFSmall]' AS "variable", COALESCE((SELECT "avg_waste_in_place_tons" FROM "avg_size" WHERE "LFSize" = 'LFSmall'), 0.0) AS "val_2015"
                                                                     , 0.0::NUMERIC                                                                                 AS "val_2016"
                                                                     , 0.0::NUMERIC                                                                                 AS "val_2017"
                                                                     , 0.0::NUMERIC                                                                                 AS "val_2018"
                                                                     , 0.0::NUMERIC                                                                                 AS "val_2019"
                                                                     , 0.0::NUMERIC                                                                                 AS "val_2020"
                                                                     , 0.0::NUMERIC                                                                                 AS "val_2021"
                                                                     , 0.0::NUMERIC                                                                                 AS "val_2022"
                                                                     , 0.0::NUMERIC                                                                                 AS "val_2023"
                                                                     , 0.0::NUMERIC                                                                                 AS "val_2024"
                                                                     , 0.0::NUMERIC                                                                                 AS "val_2025"
                                                                     , 0.0::NUMERIC                                                                                 AS "val_2026"
                                                                     , 0.0::NUMERIC                                                                                 AS "val_2027"
                                                                     , 0.0::NUMERIC                                                                                 AS "val_2028"
                                                                     , 0.0::NUMERIC                                                                                 AS "val_2029"
                                                                     , 0.0::NUMERIC                                                                                 AS "val_2030"
                                                                     , 0.0::NUMERIC                                                                                 AS "val_2031"
                                                                     , 0.0::NUMERIC                                                                                 AS "val_2032"
                                                                     , 0.0::NUMERIC                                                                                 AS "val_2033"
                                                                     , 0.0::NUMERIC                                                                                 AS "val_2034"
                                                                     , 0.0::NUMERIC                                                                                 AS "val_2035"
                                                                     , 0.0::NUMERIC                                                                                 AS "val_2036"
                                                                     , 0.0::NUMERIC                                                                                 AS "val_2037"
                                                                     , 0.0::NUMERIC                                                                                 AS "val_2038"
                                                                     , 0.0::NUMERIC                                                                                 AS "val_2039"
                                                                     , 0.0::NUMERIC                                                                                 AS "val_2040"
);
